const left = 37;
const up = 38;
const right = 39;
const down = 40;
const enter = 13;

let states = ["home", "menu", "menu_server", "search", "more", "details", "settings"];
let indexes = {"home": false, "menu": false, "menu_server": false, "search": false, "more": false, "details": false,"settings": false}
let focusBlock = null;
let menupoll = [];

let clickOn = function(e) {
    var clickEvent = new MouseEvent("click", {
        "view": window,
        "bubbles": true,
        "cancelable": false
    });
    e.dispatchEvent(clickEvent);
}

let onKeyDown = function(e) {
    keyCode = (e||window.event).keyCode;
    if(focusBlock == null) {
        
        return; 
    }
    switch(focusBlock) {
        case null:
            if(keyCode == up){
                focusBlock = "menu";
            }else{
                focusBlock = "home";
            }
            break;
        case "menu":
            menuNav(keyCode);
            break;
        case "home":
            homeNav(keyCode);
            break;

    }




}

let menuNav = function(keyCode){
    if(keyCode == 40){
        //down
        menucapture = false;
        lastMenu.classList.remove("mfocus");
        arrowNav(null);
    }else if(keyCode == 37){
        //left
        let aindex = menubuttons.indexOf(lastMenu.id);
        if(aindex > 0){
            if(aindex == 1 && document.getElementById("back_button").style.display != "block"){
                return;
            }
            let desp = 1;
            if(aindex == 4 && document.getElementById("more_button").style.display != "block"){
                desp = 3;
            }
            lastMenu.classList.remove("mfocus");
            lastMenu = document.getElementById(menubuttons[aindex - desp]);
            lastMenu.classList.add("mfocus");
        }
    }else if(keyCode == 39){
        //right
        let aindex = menubuttons.indexOf(lastMenu.id);
        if(aindex < menubuttons.length - 1){
            let desp = 1;
            if(aindex == 1 && document.getElementById("more_button").style.display != "block"){
                desp = 3;
            }
            lastMenu.classList.remove("mfocus");
            lastMenu = document.getElementById(menubuttons[aindex + desp]);
            lastMenu.classList.add("mfocus");
        }
    }else if (keyCode == '13') {
        // enter
        var clickEvent = new MouseEvent("click", {
            "view": window,
            "bubbles": true,
            "cancelable": false
        });
        lastMenu.dispatchEvent(clickEvent);
        let aindex =
}



let homeNav = function(keyCode){

}
